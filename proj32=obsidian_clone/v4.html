<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Viewer with JS Execution</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            margin: 20px 0;
        }
        
        header {
            background: #4a4e69;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .description {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .editor-preview {
            display: flex;
            height: 500px;
            border-top: 1px solid #eee;
        }
        
        .editor, .preview {
            flex: 1;
            padding: 20px;
            overflow: auto;
        }
        
        .editor {
            border-right: 1px solid #eee;
            background: #f9f9f9;
        }
        
        textarea {
            width: 100%;
            height: 100%;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: none;
        }
        
        .preview {
            background: white;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            background: #f5f5f5;
            border-top: 1px solid #eee;
        }
        
        button {
            background: #4a4e69;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #5a5e79;
        }
        
        .info-box {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            max-width: 1200px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .info-box h2 {
            color: #4a4e69;
            margin-bottom: 15px;
            border-bottom: 2px solid #4a4e69;
            padding-bottom: 10px;
        }
        
        .info-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .info-section {
            flex: 1;
            min-width: 300px;
        }
        
        .info-section h3 {
            color: #4a4e69;
            margin-bottom: 10px;
        }
        
        .info-section ul {
            padding-left: 20px;
        }
        
        .info-section li {
            margin-bottom: 8px;
        }
        
        code {
            background: #f5f5f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }
        
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow: auto;
            margin: 15px 0;
        }
        
        pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Markdown Viewer with JavaScript Execution</h1>
            <p class="description">A tool that renders Markdown, HTML, CSS, and executes JavaScript just like a browser</p>
        </header>
        
        <div class="editor-preview">
            <div class="editor">
                <textarea id="editor"><div class="philosopher-card" style="background: linear-gradient(to right, #667eea, #764ba2); padding: 20px; border-radius: 10px; margin: 25px 0; color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.2);">
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Immanuel_Kant_%28painted_portrait%29.jpg/200px-Immanuel_Kant_%28painted_portrait%29.jpg" alt="Immanuel Kant" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; display: block; margin: 0 auto; border: 3px solid white;">
  <h2 style="text-align: center; margin: 15px 0; color: white; font-family: 'Georgia', serif;">Immanuel Kant</h2>
  <h3 style="text-align: center; margin: 10px 0; color: #ffd700; font-style: italic;">Categorical Imperative</h3>
  
  <label for="kant-toggle" style="display: inline-block; padding: 8px 15px; background: #ffd700; color: #333; border-radius: 4px; cursor: pointer; margin: 10px 0; font-weight: bold;">Toggle Details</label>
  <input id="kant-toggle" type="checkbox" style="display: none;">
  
  <div>
    <blockquote style="font-style: italic; text-align: center; border-left: 3px solid #ffd700; padding: 10px; margin: 15px 0; background: rgba(255, 215, 0, 0.1);">"Act only according to that maxim whereby you can at the same time will that it should become a universal law."</blockquote>
    <img src="https://i.pinimg.com/736x/3a/3b/6a/3a3b6a6a6a6a6a6a6a6a6a6a6a6a6a6a.jpg" alt="Categorical Imperative" style="width: 100%; border-radius: 8px; margin: 15px 0;">
    <p style="text-align: justify; line-height: 1.6;">Kant revolutionized ethics with his concept of the categorical imperative - a universal moral law that applies to all rational beings. He argued that moral actions must be guided by principles that could apply universally, and that we should treat humanity always as an end in itself, never merely as a means.</p>
  </div>
</div>

<!-- JavaScript to handle the toggle functionality -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const toggle = document.getElementById('kant-toggle');
    const details = document.querySelector('.philosopher-card div:last-child');
    const label = document.querySelector('label[for="kant-toggle"]');
    
    if (toggle && details && label) {
        // Initialize the details state
        details.style.maxHeight = '0';
        details.style.overflow = 'hidden';
        details.style.transition = 'max-height 0.5s ease';
        
        // Add click event to the label
        label.addEventListener('click', function() {
            toggle.checked = !toggle.checked;
            
            if (toggle.checked) {
                details.style.maxHeight = details.scrollHeight + 'px';
            } else {
                details.style.maxHeight = '0';
            }
        });
    }
});
</script></textarea>
            </div>
            <div class="preview" id="preview">
                <!-- Preview will be rendered here -->
            </div>
        </div>
        
        <div class="controls">
            <button id="render-btn">Render Content</button>
            <button id="clear-btn">Clear</button>
        </div>
    </div>
    
    <div class="info-box">
        <h2>How JavaScript Execution Works in Markdown</h2>
        <div class="info-content">
            <div class="info-section">
                <h3>The Challenge</h3>
                <p>When you add JavaScript to Markdown, the browser doesn't automatically execute it because:</p>
                <ul>
                    <li>Script tags inserted as HTML text aren't executed by browsers</li>
                    <li>Security restrictions prevent automatic execution of dynamic scripts</li>
                    <li>Markdown parsers treat script tags as regular text content</li>
                </ul>
            </div>
            <div class="info-section">
                <h3>The Solution</h3>
                <p>To make JavaScript work in Markdown, we need to:</p>
                <ul>
                    <li>Parse the Markdown to HTML</li>
                    <li>Extract script tags from the generated HTML</li>
                    <li>Create new script elements and add them to the DOM</li>
                    <li>Execute the JavaScript code programmatically</li>
                </ul>
            </div>
            <div class="info-section">
                <h3>Example Code</h3>
                <pre><code>// Extract and execute scripts
const scripts = preview.querySelectorAll('script');
for (let script of scripts) {
    const newScript = document.createElement('script');
    newScript.text = script.innerHTML;
    document.body.appendChild(newScript).remove();
}</code></pre>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const editor = document.getElementById('editor');
            const preview = document.getElementById('preview');
            const renderBtn = document.getElementById('render-btn');
            const clearBtn = document.getElementById('clear-btn');
            
            // Configure marked to not sanitize HTML
            marked.setOptions({
                breaks: true,
                gfm: true,
                sanitize: false  // This allows HTML tags to pass through
            });
            
            // Function to render Markdown and execute JavaScript
            function renderContent() {
                const markdownText = editor.value;
                const htmlContent = marked.parse(markdownText);
                
                // Render the HTML content
                preview.innerHTML = htmlContent;
                
                // Extract and execute any script tags
                const scripts = preview.querySelectorAll('script');
                for (let script of scripts) {
                    try {
                        const newScript = document.createElement('script');
                        newScript.text = script.innerHTML;
                        document.body.appendChild(newScript);
                        document.body.removeChild(newScript);
                    } catch (error) {
                        console.error('Error executing script:', error);
                    }
                }
            }
            
            // Initial render
            renderContent();
            
            // Event listeners
            renderBtn.addEventListener('click', renderContent);
            
            clearBtn.addEventListener('click', function() {
                editor.value = '';
                preview.innerHTML = '';
            });
        });
    </script>
</body>
</html>